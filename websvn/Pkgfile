# Description:  PHP based web interface of Subversion repositories
# URL:          http://websvn.tigris.org/
# Maintainer:   Jose V Beneyto, joberui at ei dot upv dot es
# Packager:     Jose V Beneyto, joberui at ei dot upv dot es
# Depends on:   subversion,mod_php,enscript,diffutils,sed,gzip,tar

name=websvn
version=2.0rc4
release=1
source=()

build() {
        cd $PKGMK_SOURCE_DIR
        if cd $name ; then
                echo -e "\n" | svn update --username guest
        else
                echo -e "\n" | svn co http://websvn.tigris.org/svn/$name/tags/$version $name --username guest
        fi

        install -d $PKG/var/www/htdocs
        cp -r $PKGMK_SOURCE_DIR/$name $PKG/var/www/htdocs
        rm -rf $PKG/var/www/htdocs/$name/{.svn,*/.svn,*/*/.svn}

        mv $PKG/var/www/htdocs/$name/include/distconfig.inc \
                $PKG/var/www/htdocs/$name/include/config.inc
        sed -i 's|// $config->useEnscript|$config->useEnscript|g' \
                $PKG/var/www/htdocs/$name/include/config.inc
        sed -i "s|/home/junx/docs/wsvn|$PKG/var/www/htdocs/$name|g" \
                $PKG/var/www/htdocs/$name/wsvn.php
        chown -R nobody.nobody $PKG/var/www/htdocs/$name
}
