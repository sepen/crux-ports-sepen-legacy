# Description: Multi-platform multi-network peer-to-peer client.
# URL: http://mldonkey.sourceforge.net/
# Maintainer: Jose V Beneyto, sepen at users dot sourceforge dot net
# Packager: Jose V Beneyto, sepen at users dot sourceforge dot net
# Depends on: ocaml,libgd,bzip2

name=mldonkey
version=2.9.2
release=5
source=(http://dl.sourceforge.net/sourceforge/${name}/${name}-${version}.tar.bz2 \
        mlnetd)

build() {
  OCAML_VER=$(pkginfo -i | grep ocaml | cut -d' ' -f2 | sed 's|-[0-9]*||')
  cd ${name}-${version}
  ./configure --prefix=/usr \
              --disable-gui \
              --enable-ocamlver=${OCAML_VER} \
              --disable-debug
  make
  make DESTDIR=${PKG} install
  install -d ${PKG}/var/mlnet
  install -D -m 0755 ${SRC}/mlnetd ${PKG}/etc/rc.d/mlnetd
}
